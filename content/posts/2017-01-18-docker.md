+++
draft = true
date = "2017-01-18"
title = "Docker"
description = "???"
categories = ["todo"]
tags = ["Docker"]
+++

## Commands

### Start and stop

#### Run nginx

```
docker run -d -p 80:80 --name webserver nginx
```

http://localhost

```
docker run <CONTAINER_ID>
docker stop <CONTAINER_ID>
```

Options:

* `-d` - "detached" mode, in the background
* `-p 8080:8080` - expose port to host
* `-v ~/nginxlogs:/var/log/nginx` - set up a volume that links the `/var/log/nginx` directory from inside the Nginx container to the `~/nginxlogs` directory on the host machine. Docker uses a `:` to split the host's path from the container path, and the host path always comes first.
* `attach` - attach to a running container

#### Stop all

```
docker stop $(docker ps -a -q)
```

#### Remove all containers

```
docker rm $(docker ps -a -q)
```

#### Remove all images

```
docker rmi $(docker images -a -q)
```

### Dockerfile

```
FROM postgres:9.6
ENV POSTGRES_USER aurator
ENV POSTGRES_PASSWORD aurator
ENV POSTGRES_DB aurator
```

```
docker build -t aurator-postgres-db .
docker run -d -p 5432:5432 aurator-postgres-db
```

### RUN vs CMD vs ENTRYPOINT

http://stackoverflow.com/questions/21553353/what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile

### Other

```
# docker run -p 5432:5432 -v /Users/michal/Dropbox/Projekty/kotlin/aurator-sql/db/docker/pgdata:/var/lib/postgresql/data aurator-db
# docker run -p 5432:5432 -v pgdata:/var/lib/postgresql/data aurator-db
```

## Links

* https://www.digitalocean.com/community/tutorials/how-to-work-with-docker-data-volumes-on-ubuntu-14-04
* https://docs.docker.com/engine/tutorials/dockervolumes/
* https://hub.docker.com/_/postgres/
* https://docs.docker.com/engine/examples/postgresql_service/
* https://www.digitalocean.com/community/tutorials/docker-explained-using-dockerfiles-to-automate-building-of-images
* http://stackoverflow.com/questions/21553353/what-is-the-difference-between-cmd-and-entrypoint-in-a-dockerfile
* http://stackoverflow.com/questions/26598738/how-to-create-user-database-in-script-for-docker-postgres